# Changelog
All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](http://keepachangelog.com/en/1.0.0/)
and this project adheres to [Semantic Versioning](http://semver.org/spec/v2.0.0.html).

## [Unreleased]
### Added
- Plugins now have access to service and function annotations.

## [1.10.0] - 2018-01-11
### Removed
- Removed version check. Version checks would force code regeneration after
  installing backward-compatible versions of ThriftRW. This change relaxes that
  requirement.

## [1.9.0] - 2017-12-12
### Added
- Adds support for EnvelopeAgnosticProtocol. This upcast for protocol.Binary
  can decode both enveloped or not-enveloped requests and respond in kind, by
  exploiting the non-overlapping grammars of these message types.
- Generated enum types now include a `Ptr()` method.

## [1.8.0] - 2017-09-29
### Added
- Plugins: Annotations declared on user-defined types are now exposed on
  `TypeReference`.

### Changed
- Optional fields of generated structs now enable the `omitempty` JSON option
  if the field holds a list, set, or map.

## [1.7.0] - 2017-09-12
### Added
- AST: Parts of the AST now support parsing docstrings in the `/** ... */`
  style.
- Docstrings on types in the Thrift file are now included in the generated
  code.

## [1.6.0] - 2017-08-28
### Added
- Structs now include getter functions for primitive types.
- Fields of generated struct types are now tagged with easyjson-compatible
  `required` tags.

### Fixed
- Fixed code generation bug for default values of fields with a `typedef` type.

## [1.5.0] - 2017-08-03
### Added
- Code generated by ThriftRW now conforms to
  <https://golang.org/s/generatedcode>.

### Fixed
- Removed gomock and testify from Glide imports to test imports.

## [1.4.0] - 2017-07-21
### Added
- Added support for `go.tag` annotations on struct fields. Corresponding fields
  of the generated Go structs will be tagged with these values.
- AST: Added a `LineNumber` function to get the line on which an AST Node was
  defined.

## [1.3.0] - 2017-07-05
### Added
- Plugins: Added support for overriding the communication channels used by
  plugins.
- Enums now implement the `encoding.TextUnmarshaler` interface. This allows
  retrieving enum values by name and integrates better with other encoding
  formats.
- Enums now have a `<EnumName>_Values()` function which returns all known
  values for that enum.

### Fixed
- Plugins: Template output is now compliant with gofmt.

## [1.2.0] - 2017-04-17
### Added
- The Thrift IDL is now embedded withing the generated package. It is
  accessible via the package global ThriftModule.

## [1.1.0] - 2017-03-23
### Added
- `Equals()` methods are now generated for all custom types.
- Added flags `--no-types`, `--no-constants`, `--no-service-helpers`.
- AST: All type references and complex constant values now record the line
  numbers on which they were specified.
- AST: Added a Node interface to unify different AST object types.
- AST: Added Walk to traverse the AST using a Visitor.

### Fixed
- Handle `nil` values in generated `String()` methods.
- Plugins: Fail code generation if communication with a plugin fails to
  disconnect properly.
- Fixed conflicts in helper functions when imported types had names similar to
  locally defined types.

## [1.0.0] - 2016-11-14
### Changed
- Field names `ToWire`, `FromWire`, `String`, and for exceptions `Error` are
  now reserved. Override the names of these fields in the generated code with
  the `go.name` annotation.
- Plugins: The version of ThriftRW used to compile the plugin is now matched
  against the version actually generating code.

## [0.5.0] - 2016-11-10
### Added
- A `go.name` annotation may now be specified to override the names of entities
  in the generated Go code. The annotation is supported for struct, union, and
  exception types, and their fields, enum types and enum items, and parameters
  of functions.
- Plugins: Added a new `Service.Name` field which contains the name of field
  normalized per Go naming conventions. This, along with `Function.Name` may be
  used to build the names of the `Args`, `Result`, and `Helper` types for a
  function.

### Changed
- **Breaking**: Generated enums now have first-class JSON support. Enums are
  (un)marshalled from/to strings if possible with fallback to integer for
  unrecognized values.
- **Breaking**: `Args`, `Result`, and `Helper` types for service functions are
  now generated in the same package as the user-defined types. These types are
  now named similarly to `$service_$function_Args` where `$service` and
  `$function` are the names of the Thrift service and function normalized based
  on Go naming conventions.
- Code generation will abort if struct fields, after conversion to Go style
  names, are not unique in the structure.
- Plugins: Renamed `Service.Name` to `Service.ThriftName` since it contains the
  name of the service as it appeared in the Thrift file.
- Plugins: Constructors for `Plugin` and `ServiceGenerator` clients and
  handlers are now exposed in the same package as the interfaces.
- Non-primitive types constants are now inlined in the generated Go code
  instead of being referenced in an effort to reduce the impact of user errors
  on the generated code. This is because non-primitive constants were
  previously implemented as global `var`s which might be modified by user code.

### Removed
- Plugins: Removed `Service.Directory` and `Service.ImportPath` because these
  are now same as the corresponding module.

## [0.4.0] - 2016-11-01
### Added
- Expose whether a function is oneway to plugins.
- Expose the version of the library under
  `go.uber.org/thriftrw/version.Version`.
- Generated code will test for version compatibility with the current version
  of ThriftRW during initialization.

### Changed
- **Breaking**: The `compile` API now exposes annotations made while
  referencing native Thrift types. This changes the `TypeSpec`s for primitive
  types from values to types.
- The `compile` API now also exposes annotations for `typedef` declarations.
- Generate args structs and helpers for oneway functions.

### Removed
- **Breaking**: Remove the `--yarpc` flag. Install the ThriftRW YARPC plugin
  from `go.uber.org/yarpc/encoding/thrift/thriftrw-plugin-yarpc` and use
  `--plugin=yarpc` instead.

## [0.3.2] - 2016-10-05
### Fixed
- Fix import paths for code generated using `--yarpc`. Note that this flag will
  be removed in a future version.

## [0.3.1] - 2016-09-30
### Fixed
- Fix missing canonical import path to `go.uber.org/thriftrw`.

## [0.3.0] - 2016-09-29
### Changed
- **Breaking**: Renamed project to `go.uber.org/thriftrw`.
- **Breaking**: Keywords reserved by Apache Thrift are now disallowed as
  identifiers in Thrift files.
- **Breaking**: The `Package` field of the `plugin.TypeReference`,
  `plugin.Service`, and `plugin.Module` structs was renamed to `ImportPath`.

## [0.2.1] - 2016-09-27
### Added
- Plugin templates: Imports in generated code are now always qualified if the
  package name doesn't match the base name.

### Fixed
- Plugin templates: Fixed a bug where imports in templates would use the base
  name of the package even if it had a hyphen in it if it wasn't available on
  the `GOPATH`.

## [0.2.0] - 2016-09-09
### Added
- Added a `-v`/`--version` flag.
- Added a plugin system.

  ThriftRW now provides a plugin system to allow customizing code generation.
  Initially, only the generated code for `service` declarations is
  customizable. Check the documentation for more details.

### Changed
- **Breaking**: The `String()` method for `enum` types now returns the name of
  the item as specified in the Thrift file.

### Fixed
- **Breaking**: Fixed a bug where all-caps attributes that are not known
  abbreviations were changed to PascalCase.

## 0.1.0 - 2016-08-31
### Added
- Initial release.

[Unreleased]: https://github.com/thriftrw/thriftrw-go/compare/v1.9.0...HEAD
[1.9.0]: https://github.com/thriftrw/thriftrw-go/compare/v1.8.0...v1.9.0
[1.8.0]: https://github.com/thriftrw/thriftrw-go/compare/v1.7.0...v1.8.0
[1.7.0]: https://github.com/thriftrw/thriftrw-go/compare/v1.6.0...v1.7.0
[1.6.0]: https://github.com/thriftrw/thriftrw-go/compare/v1.5.0...v1.6.0
[1.5.0]: https://github.com/thriftrw/thriftrw-go/compare/v1.4.0...v1.5.0
[1.4.0]: https://github.com/thriftrw/thriftrw-go/compare/v1.3.0...v1.4.0
[1.3.0]: https://github.com/thriftrw/thriftrw-go/compare/v1.2.0...v1.3.0
[1.2.0]: https://github.com/thriftrw/thriftrw-go/compare/v1.1.0...v1.2.0
[1.1.0]: https://github.com/thriftrw/thriftrw-go/compare/v1.0.0...v1.1.0
[1.0.0]: https://github.com/thriftrw/thriftrw-go/compare/v0.5.0...v1.0.0
[0.5.0]: https://github.com/thriftrw/thriftrw-go/compare/v0.4.0...v0.5.0
[0.4.0]: https://github.com/thriftrw/thriftrw-go/compare/v0.3.2...v0.4.0
[0.3.2]: https://github.com/thriftrw/thriftrw-go/compare/v0.3.1...v0.3.2
[0.3.1]: https://github.com/thriftrw/thriftrw-go/compare/v0.3.0...v0.3.1
[0.3.0]: https://github.com/thriftrw/thriftrw-go/compare/v0.2.1...v0.3.0
[0.2.1]: https://github.com/thriftrw/thriftrw-go/compare/v0.2.0...v0.2.1
[0.2.0]: https://github.com/thriftrw/thriftrw-go/compare/v0.1.0...v0.2.0
